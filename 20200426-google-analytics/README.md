# Google Analytics を追加してみた

このブログは個人的な練習場なので一般公開している意味は特にないが、それでも自分以外の誰かがここに書かれている記事を見て、何かしらの意味で役に立つようなことがあればありがたいとは思う。その意味で、少しこのブログは誰かが見ているのかなというのを知りたくなったので、Google Analytics を導入してみた。

## 事前学習

とりあえずサイトへの流入量くらいがわかればそれ以上はあまり期待していなかったのだが、色々とよく見ていくと Google Analytics は本格的に企業のためのサイトを運用するような人たちのために作られているツールのようので、それ以上のことが色々とできる。もっとシンプルなサービスを見つけられればそちらでもよかったのだが、とりあえずよく聞くので Google Analytics でやることにした。

ある程度複雑そうなのでとりあえずざっと全体像を掴むために1時間ほど次のコースを見た。

- [Google Analytics for Beginners](https://analytics.google.com/analytics/academy/course/6)

ユーザーがサイトのどこを訪れているかとか、どういうユーザーが訪れているかとか、そういう情報まで取ることができるらしい。それらが全て無料なのは流石にすごいことだなと思ったがどうやって収益につなげているんだろうか。広告オプションがいっぱいあるからそれかなと思いつつ、発展的な内容に触れることは多分ないのでそちらには手を触れずにおいた。

そのコースで唯一わからなかったのがアカウントの構造、特にPropertyとViewの違いについてだったので、このページ

- [Googleアナリティクスのアカウント構造を理解しよう](https://ferret-plus.com/curriculums/10019)

を読んでとりあえずざっくりとは理解した。Propertyが大体一つのサイトにあたって、そのデータをGoogleがどこかにためてくれるから、そのデータのViewを作っていくみたいな形だと理解すれば良さそう。今回は複雑なデータをとるわけではないので、Propertyはこのブログを指定して、Viewは一つとりあえず全てのデータが見れるものを用意しておけば問題なさそうだ。

## Global Site Tag の設置

このブログは独自の静的サイト生成スクリプトで生成されているので、データを貯めるためのjsタグも手で埋め込むことにした。単純に`&lt;head&gt;&lt;/head&gt;`の間に指定されたタグを埋め込んでおくだけで良さそうなので、特に何の問題も起こらずに終わった。

少し気になっていたのは Github Pages がjsを発火してくれるかどうかだったが、よく考えればすでにいくつか数式系を使うためにjsを発火させていたので問題はなさそう。他の人も同じように単純に貼り付けるだけでうまくいっているようだし、多分問題はないはず。

- [GitHubPagesにGoogle Analyticsを設定](https://qiita.com/weekendhikach/items/c46039fb50759b6b5c3e)

テストtrafficを流してみると、きちんと使っているユーザーが増えたので多分設置はできたはず。

<img src="/20200426-google-analytics/test_traffic.png" width="40%" alt="test traffic">

## 設置後の集計反映

この記事を書いている途中に、テストのためだったり色々他の作業のために自分のブログに幾度もアクセスしているが、Hourlyで見てもアクセス数が増えていないので、多分ログの集計は一日ごとだったりするのではなかろうか。気長に、もし誰かが見てくれていたらありがたいなくらいの感じで、見続けて行こうかなと思う。
